<project xmlns="http://maven.apache.org/POM/4.0.0"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>

	<groupId>edu.mikedev</groupId>
	<artifactId>task-manager</artifactId>
	<version>0.0.1-SNAPSHOT</version>
	<packaging>jar</packaging>

	<name>task-manager</name>
	<url>http://maven.apache.org</url>

	<properties>
		<project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
		<maven.compiler.source>1.8</maven.compiler.source>
		<maven.compiler.target>1.8</maven.compiler.target>
	</properties>
	<build>
		<plugins>
			<plugin>
				<groupId>io.fabric8</groupId>
				<artifactId>docker-maven-plugin</artifactId>
				<version>0.38.1</version>
				<configuration>
					<autoCreateCustomNetworks>true</autoCreateCustomNetworks>
					<useColor>true</useColor>
					<images>
						<image>
							<name>task-manager</name>
							<build>
								<dockerFile>${project.basedir}/Dockerfile</dockerFile>
								<ports>
									<port>38839</port>
								</ports>
							</build>
							<run>
								<autoRemove>true</autoRemove>
								<containerNamePattern> task-manager </containerNamePattern>
								<network>
									<name>my-network</name>
									<mode>custom</mode>
								</network>
								<ports>
									<port>38839:38839</port>
								</ports>
								<dependsOn>postgres</dependsOn>
							</run>
						</image>
						<image>
							<name>postgres:14.1-alpine</name>
							<alias>postgres</alias>
							<run>
								<network>
									<name>my-network</name>
									<mode>custom</mode>
								</network>
								<env>
									<POSTGRES_USER>user</POSTGRES_USER>
									<POSTGRES_DB>task_manager</POSTGRES_DB>
									<POSTGRES_PASSWORD>password</POSTGRES_PASSWORD>
								</env>
								<ports>
									<port>5432:5432</port>
								</ports>
								<wait>
									<tcp>
										<ports>
											<port>5432</port>
										</ports>
									</tcp>
								</wait>
							</run>
						</image>
					</images>
				</configuration>
			</plugin>
		</plugins>
	</build>
	<dependencies>
		<dependency>
			<groupId>junit</groupId>
			<artifactId>junit</artifactId>
			<version>4.13.2</version>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>org.jbehave</groupId>
			<artifactId>jbehave-core</artifactId>
			<version>4.8.3</version>
		</dependency>
		<dependency>
			<groupId>org.pitest</groupId>
			<artifactId>pitest-maven</artifactId>
			<version>1.7.3</version>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>org.assertj</groupId>
			<artifactId>assertj-swing-junit</artifactId>
			<version>3.9.2</version>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>org.mockito</groupId>
			<artifactId>mockito-core</artifactId>
			<version>4.2.0</version>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>net.jqwik</groupId>
			<artifactId>jqwik</artifactId>
			<version>1.6.2</version>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>org.hibernate</groupId>
			<artifactId>hibernate-core</artifactId>
			<version>5.6.2.Final</version>
		</dependency>
	</dependencies>
	<profiles>
		<profile>
			<id>jacoco-coverage</id>
			<build>
				<plugins>
					<plugin>
						<groupId>org.jacoco</groupId>
						<artifactId>jacoco-maven-plugin</artifactId>
						<version>0.8.7</version>
						<configuration>
							<excludes>
								<exclude>**/Main.*</exclude>
							</excludes>
						</configuration>
						<executions>
							<execution>
								<goals>
									<!-- Binded to Initialize -->
									<goal>prepare-agent</goal>
									<!-- Binded to verify -->
									<goal>report</goal>
								</goals>
							</execution>
						</executions>
					</plugin>
				</plugins>
			</build>
		</profile>
		<profile>
			<id>mutation-testing</id>
			<build>
				<plugins>
					<plugin>
						<groupId>org.pitest</groupId>
						<artifactId>pitest-maven</artifactId>
						<version>1.7.3</version>
						<configuration>
							<targetClasses>
								<param>edu.mikedev.*</param>
							</targetClasses>
							<targetTests>
								<param>edu.mikedev.*</param>
							</targetTests>
						</configuration>
						<executions>
							<execution>
								<phase>test</phase>
								<goals>
									<goal>mutationCoverage</goal>
								</goals>
							</execution>
						</executions>
					</plugin>
				</plugins>
			</build>
		</profile>
	</profiles>
</project>